<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>29-è„šæ‰‹æ¶å‘å¸ƒæ¨¡å¼gitè‡ªåŠ¨åŒ–æµç¨‹å¼€å‘ | ä»Šæ—¥å‰ç«¯</title>
    <meta name="generator" content="VuePress 1.9.10">
    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?4ef6dc604509807e9702b3851e114a74";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
      </script>
      </script>
    <script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1183508160150958" crossorigin="anonymous"></script>
    <meta name="description" content="è„šæ‰‹æ¶å‘å¸ƒæ¨¡å¼gitè‡ªåŠ¨åŒ–æµç¨‹å¼€å‘">
    
    <link rel="preload" href="/assets/css/0.styles.ab222855.css" as="style"><link rel="preload" href="/assets/js/app.4690e35c.js" as="script"><link rel="preload" href="/assets/js/2.505fbce2.js" as="script"><link rel="preload" href="/assets/js/1.8644e8ec.js" as="script"><link rel="preload" href="/assets/js/76.886902cd.js" as="script"><link rel="prefetch" href="/assets/js/10.cab30127.js"><link rel="prefetch" href="/assets/js/11.dd4acf6f.js"><link rel="prefetch" href="/assets/js/12.30378d2b.js"><link rel="prefetch" href="/assets/js/13.52db13dd.js"><link rel="prefetch" href="/assets/js/14.b1e55c9a.js"><link rel="prefetch" href="/assets/js/15.397321e8.js"><link rel="prefetch" href="/assets/js/16.41ea9dc0.js"><link rel="prefetch" href="/assets/js/17.ae9bd38c.js"><link rel="prefetch" href="/assets/js/18.7f05db4f.js"><link rel="prefetch" href="/assets/js/19.e7419ed2.js"><link rel="prefetch" href="/assets/js/20.5de11ad9.js"><link rel="prefetch" href="/assets/js/21.d1e22ea1.js"><link rel="prefetch" href="/assets/js/22.72ada26c.js"><link rel="prefetch" href="/assets/js/23.c0a0b2d8.js"><link rel="prefetch" href="/assets/js/24.3e816b8b.js"><link rel="prefetch" href="/assets/js/25.3f733c03.js"><link rel="prefetch" href="/assets/js/26.db25a028.js"><link rel="prefetch" href="/assets/js/27.15ed1846.js"><link rel="prefetch" href="/assets/js/28.208ac68e.js"><link rel="prefetch" href="/assets/js/29.69d9bd33.js"><link rel="prefetch" href="/assets/js/3.7a4ab8e5.js"><link rel="prefetch" href="/assets/js/30.f039addb.js"><link rel="prefetch" href="/assets/js/31.b9fd445b.js"><link rel="prefetch" href="/assets/js/32.899591cb.js"><link rel="prefetch" href="/assets/js/33.f3808942.js"><link rel="prefetch" href="/assets/js/34.1c51bd04.js"><link rel="prefetch" href="/assets/js/35.5dec34de.js"><link rel="prefetch" href="/assets/js/36.08add187.js"><link rel="prefetch" href="/assets/js/37.5feb420b.js"><link rel="prefetch" href="/assets/js/38.afefe479.js"><link rel="prefetch" href="/assets/js/39.c9cdfded.js"><link rel="prefetch" href="/assets/js/4.0aef8d22.js"><link rel="prefetch" href="/assets/js/40.96b04497.js"><link rel="prefetch" href="/assets/js/41.04859dc6.js"><link rel="prefetch" href="/assets/js/42.3881136d.js"><link rel="prefetch" href="/assets/js/43.d142a153.js"><link rel="prefetch" href="/assets/js/44.5cb88048.js"><link rel="prefetch" href="/assets/js/45.3541cd11.js"><link rel="prefetch" href="/assets/js/46.e6c88c3b.js"><link rel="prefetch" href="/assets/js/47.3f992b97.js"><link rel="prefetch" href="/assets/js/48.5996b4fc.js"><link rel="prefetch" href="/assets/js/49.fea4d36b.js"><link rel="prefetch" href="/assets/js/5.baaddd77.js"><link rel="prefetch" href="/assets/js/50.4cd3422c.js"><link rel="prefetch" href="/assets/js/51.228fffda.js"><link rel="prefetch" href="/assets/js/52.92861e6c.js"><link rel="prefetch" href="/assets/js/53.b72d8ce0.js"><link rel="prefetch" href="/assets/js/54.c15c9cdc.js"><link rel="prefetch" href="/assets/js/55.9bc4f52b.js"><link rel="prefetch" href="/assets/js/56.947ab898.js"><link rel="prefetch" href="/assets/js/57.fa37cf58.js"><link rel="prefetch" href="/assets/js/58.d682c2a2.js"><link rel="prefetch" href="/assets/js/59.4499ef43.js"><link rel="prefetch" href="/assets/js/6.f5ab8614.js"><link rel="prefetch" href="/assets/js/60.aa57de27.js"><link rel="prefetch" href="/assets/js/61.5049d857.js"><link rel="prefetch" href="/assets/js/62.ec9a8087.js"><link rel="prefetch" href="/assets/js/63.38b9610d.js"><link rel="prefetch" href="/assets/js/64.0034d3be.js"><link rel="prefetch" href="/assets/js/65.5a44c8b1.js"><link rel="prefetch" href="/assets/js/66.ad0a55cb.js"><link rel="prefetch" href="/assets/js/67.ab2beac7.js"><link rel="prefetch" href="/assets/js/68.fa3c4346.js"><link rel="prefetch" href="/assets/js/69.4c304a67.js"><link rel="prefetch" href="/assets/js/7.62e43543.js"><link rel="prefetch" href="/assets/js/70.9965b915.js"><link rel="prefetch" href="/assets/js/71.f5f8e219.js"><link rel="prefetch" href="/assets/js/72.afe95f75.js"><link rel="prefetch" href="/assets/js/73.55da3950.js"><link rel="prefetch" href="/assets/js/74.860ada40.js"><link rel="prefetch" href="/assets/js/75.66a003ea.js"><link rel="prefetch" href="/assets/js/77.680b69b8.js"><link rel="prefetch" href="/assets/js/78.6440c559.js"><link rel="prefetch" href="/assets/js/79.4f3af818.js"><link rel="prefetch" href="/assets/js/80.b04f59cc.js"><link rel="prefetch" href="/assets/js/81.d4c4e4b3.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.03d43e08.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ab222855.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/favicon.ico" alt="ä»Šæ—¥å‰ç«¯" class="logo"> <span class="site-name can-hide">ä»Šæ—¥å‰ç«¯</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/daily/day30.html" class="nav-link">
  ä»Šæ—¥å‰ç«¯
</a></div><div class="nav-item"><a href="/github/before.html" class="nav-link">
  Githubç½‘ç«™é£Ÿç”¨
</a></div><div class="nav-item"><a href="/web/before.html" class="nav-link">
  å‰ç«¯è„šæ‰‹æ¶
</a></div><div class="nav-item"><a href="https://blog.liugezhou.online" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ä»–çš„åšå®¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/liugezhou/daydayup" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/daily/day30.html" class="nav-link">
  ä»Šæ—¥å‰ç«¯
</a></div><div class="nav-item"><a href="/github/before.html" class="nav-link">
  Githubç½‘ç«™é£Ÿç”¨
</a></div><div class="nav-item"><a href="/web/before.html" class="nav-link">
  å‰ç«¯è„šæ‰‹æ¶
</a></div><div class="nav-item"><a href="https://blog.liugezhou.online" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ä»–çš„åšå®¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/liugezhou/daydayup" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/web/before.html" class="sidebar-link">å…³äº</a></li><li><a href="/web/00.html" class="sidebar-link">00-æ•´ä½“æ¶æ„è®¾è®¡æ–‡æ¡£èŒƒæœ¬V0.1</a></li><li><a href="/web/01.html" class="sidebar-link">01-éœ€æ±‚åˆ†æä¸æ¶æ„è®¾è®¡</a></li><li><a href="/web/02.html" class="sidebar-link">02-è„šæ‰‹æ¶æ¶æ„è®¾è®¡å’Œæ¡†æ¶æ­å»º</a></li><li><a href="/web/03.html" class="sidebar-link">03-è„šæ‰‹æ¶æ ¸å¿ƒæµç¨‹å¼€å‘</a></li><li><a href="/web/04.html" class="sidebar-link">04-è„šæ‰‹æ¶å‘½ä»¤æ³¨å†Œå’Œæ‰§è¡Œè¿‡ç¨‹å¼€å‘</a></li><li><a href="/web/05.html" class="sidebar-link">05-è„šæ‰‹æ¶åˆ›å»ºé¡¹ç›®æµç¨‹è®¾è®¡å’Œå¼€å‘</a></li><li><a href="/web/06.html" class="sidebar-link">06-è„šæ‰‹æ¶é¡¹ç›®å’Œç»„ä»¶åˆå§‹åŒ–å¼€å‘</a></li><li><a href="/web/14.html" class="sidebar-link">14-æœåŠ¡ç«¯é€‰å‹ï¼šç£¨åˆ€ä¸å¦‚ç æŸ´åŠŸ</a></li><li><a href="/web/15.html" class="sidebar-link">15-æœåŠ¡ç«¯ CI_CDï¼šGithub è‡ªåŠ¨åŒ–</a></li><li><a href="/web/16.html" class="sidebar-link">16-ç¼–è¾‘å™¨æœåŠ¡ç«¯APIå¼€å‘</a></li><li><a href="/web/17.html" class="sidebar-link">17-ç¼–è¾‘å™¨æœåŠ¡ç«¯è°ƒç”¨ç¬¬ä¸‰æ–¹æœåŠ¡</a></li><li><a href="/web/28.html" class="sidebar-link">28-è„šæ‰‹æ¶å‘å¸ƒæ¨¡å—æ¶æ„è®¾è®¡å’Œæ ¸å¿ƒæµç¨‹å¼€å‘</a></li><li><a href="/web/29.html" aria-current="page" class="active sidebar-link">29-è„šæ‰‹æ¶å‘å¸ƒæ¨¡å¼gitè‡ªåŠ¨åŒ–æµç¨‹å¼€å‘</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web/29.html#ç¬¬ä¸€ç« -æœ¬å‘¨å¯¼å­¦" class="sidebar-link">ç¬¬ä¸€ç«  æœ¬å‘¨å¯¼å­¦</a></li><li class="sidebar-sub-header"><a href="/web/29.html#ç¬¬äºŒç« -git-flow-æ¨¡å—æ¶æ„è®¾è®¡" class="sidebar-link">ç¬¬äºŒç«  Git Flow æ¨¡å—æ¶æ„è®¾è®¡</a></li><li class="sidebar-sub-header"><a href="/web/29.html#ç¬¬ä¸‰ç« -github-gitee-api-æ¥å…¥" class="sidebar-link">ç¬¬ä¸‰ç«  Github&amp;Gitee API æ¥å…¥</a></li><li class="sidebar-sub-header"><a href="/web/29.html#ç¬¬å››ç« -gitflow-åˆå§‹åŒ–æµç¨‹å¼€å‘" class="sidebar-link">ç¬¬å››ç«  GitFlow åˆå§‹åŒ–æµç¨‹å¼€å‘</a></li><li class="sidebar-sub-header"><a href="/web/29.html#ç¬¬äº”ç« -gitflowæœ¬åœ°ä»“åº“ä»£ç è‡ªåŠ¨æäº¤" class="sidebar-link">ç¬¬äº”ç«  GitFlowæœ¬åœ°ä»“åº“ä»£ç è‡ªåŠ¨æäº¤</a></li><li class="sidebar-sub-header"><a href="/web/29.html#ç¬¬å…­ç« -æœ¬å‘¨åŠ é¤-nodeç¼–ç æœ€ä½³å®è·µ" class="sidebar-link">ç¬¬å…­ç«  æœ¬å‘¨åŠ é¤ï¼šNodeç¼–ç æœ€ä½³å®è·µ</a></li></ul></li><li><a href="/web/30.html" class="sidebar-link">30-è„šæ‰‹æ¶å‘å¸ƒæ¨¡å—äº‘æ„å»ºç³»ç»Ÿå¼€å‘</a></li><li><a href="/web/31.html" class="sidebar-link">31-è„šæ‰‹æ¶å‘å¸ƒæ¨¡å—äº‘å‘å¸ƒåŠŸèƒ½å¼€å‘</a></li><li><a href="/web/32.html" class="sidebar-link">32-è„šæ‰‹æ¶ç»„ä»¶å‘å¸ƒåŠŸèƒ½å¼€å‘</a></li><li><a href="/web/33.html" class="sidebar-link">33-ç»„ä»¶å¹³å°å¼€å‘</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="ç¬¬ä¸€ç« -æœ¬å‘¨å¯¼å­¦"><a href="#ç¬¬ä¸€ç« -æœ¬å‘¨å¯¼å­¦" class="header-anchor">#</a> ç¬¬ä¸€ç«  æœ¬å‘¨å¯¼å­¦</h2> <p><strong>1-1 æœ¬å‘¨æ•´ä½“ä»‹ç»å’Œå­¦ä¹ æ–¹æ³•</strong></p> <ul><li>GitFlowå®æˆ˜</li> <li>é€šè¿‡simple-gitæ“ä½œgitå‘½ä»¤</li> <li>Githubå’ŒGitee openAPIæ¥å…¥</li> <li>æœ¬å‘¨åŠ é¤ï¼šNodeæœ€ä½³å®è·µåˆ†äº«</li></ul> <p><strong>ä¸»è¦å†…å®¹</strong></p> <ul><li>Gitä»“åº“åˆå§‹åŒ–(åˆ©ç”¨Githubå’ŒGitee OpenAPI)</li> <li>æœ¬åœ°Gitåˆå§‹åŒ–</li> <li>GitFlowæµç¨‹å®ç°(ä»£ç è‡ªåŠ¨æäº¤)</li></ul> <p><strong>é™„èµ å†…å®¹</strong><br>
Nodeé¡¹ç›®æœ€ä½³å®è·µï¼š</p> <ul><li>é¡¹ç›®ç»“æ„æœ€ä½³å®è·µ</li> <li>å¼‚å¸¸å¤„ç†æœ€ä½³å®è·µ</li> <li>æµ‹è¯•æœ€ä½³å®è·µ</li> <li>å‘å¸ƒä¸Šçº¿æœ€ä½³å®è·µ</li> <li>å®‰å…¨æœ€ä½³å®è·µ</li></ul> <h2 id="ç¬¬äºŒç« -git-flow-æ¨¡å—æ¶æ„è®¾è®¡"><a href="#ç¬¬äºŒç« -git-flow-æ¨¡å—æ¶æ„è®¾è®¡" class="header-anchor">#</a> ç¬¬äºŒç«  Git Flow æ¨¡å—æ¶æ„è®¾è®¡</h2> <p><strong>2-1 GitFlowæ¨¡å—æ¶æ„è®¾è®¡</strong> <a href="https://www.processon.com/embed/610bf5d81e0853337b1eb8bd" target="_blank" rel="noopener noreferrer">ç‚¹å‡»æŸ¥çœ‹ã€processonã€‘<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <strong>2-2 GitFlowæµç¨‹å›é¡¾</strong></p> <p><a href="https://www.processon.com/embed/60f2487c1efad41bbea86894" target="_blank" rel="noopener noreferrer">ç‚¹å‡»æŸ¥çœ‹ã€processonã€‘<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="ç¬¬ä¸‰ç« -github-gitee-api-æ¥å…¥"><a href="#ç¬¬ä¸‰ç« -github-gitee-api-æ¥å…¥" class="header-anchor">#</a> ç¬¬ä¸‰ç«  Github&amp;Gitee API æ¥å…¥</h2> <p><strong>3-1 åˆ›å»ºGitç±»</strong></p> <ol><li>é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„package--gitï¼Œç”¨æ¥ç®¡ç†ä¸gitç›¸å…³çš„æ‰€æœ‰å†…å®¹</li></ol> <ul><li>lerna create git models/git
2. åœ¨ä¸Šå‘¨ä»£ç å†™å®Œthis.prepare()ä¹‹åï¼ˆcommands/publish/lib/index.jsä¸­ï¼‰ï¼Œæˆ‘ä»¬å°±éœ€è¦å»è°ƒç”¨è¿™ä¸ªæ–°å»ºçš„gitåŒ…ï¼Œå®ä¾‹åŒ–å‡ºæ¥ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶å°†projectInfoçš„ä¿¡æ¯ä¼ é€’è¿›å»</li> <li>const Git = require('@cloudscope-cli/git')</li> <li>const git = new Git()
3. æˆ‘ä»¬åœ¨æ–°å»ºçš„ models/git/lib/index.jsä¸­æ–°å»ºä¸€ä¸ªGitç±»ï¼Œæœ¬èŠ‚ä»£ç å†…å®¹ä¸ºï¼š</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> SimpleGit <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'simple-git'</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Git</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>name<span class="token punctuation">,</span> version<span class="token punctuation">,</span> dir<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
        <span class="token keyword">this</span><span class="token punctuation">.</span>version <span class="token operator">=</span> version
        <span class="token keyword">this</span><span class="token punctuation">.</span>dir <span class="token operator">=</span> dir
        <span class="token keyword">this</span><span class="token punctuation">.</span>git <span class="token operator">=</span> <span class="token function">SimpleGit</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>gitServer <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>

    <span class="token function">prepare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Git init'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Git<span class="token punctuation">;</span>
</code></pre></div><p><strong>3-2 ç”¨æˆ·ä¸»ç›®å½•æ£€æŸ¥é€»è¾‘å¼€å‘</strong></p> <blockquote><p>æœ¬èŠ‚çš„ä¸»è¦ä»£ç ä¸ºåœ¨Class Gitä¸­ç¼–å†™prepareæ–¹æ³•ï¼Œæ£€æŸ¥ç”¨æˆ·ä¸»ç›®å½•æ˜¯å¦å­˜åœ¨</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> SimpleGit <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'simple-git'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> userHome <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'user-home'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> log <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@cloudscope-cli/log'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fse <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs-extra'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token constant">DEFAULT_CLI_HOME</span> <span class="token operator">=</span> <span class="token string">'.cloudscope-cli'</span>
<span class="token keyword">class</span> <span class="token class-name">Git</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>name<span class="token punctuation">,</span> version<span class="token punctuation">,</span> dir<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
        <span class="token keyword">this</span><span class="token punctuation">.</span>version <span class="token operator">=</span> version
        <span class="token keyword">this</span><span class="token punctuation">.</span>dir <span class="token operator">=</span> dir
        <span class="token keyword">this</span><span class="token punctuation">.</span>git <span class="token operator">=</span> <span class="token function">SimpleGit</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>gitServer <span class="token operator">=</span> <span class="token keyword">null</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>homePath <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">async</span> <span class="token function">prepare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">checkHomePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æ£€æŸ¥ç¼“å­˜ä¸»ç›®å½•</span>
    <span class="token punctuation">}</span>

    <span class="token function">checkHomePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>homePath<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">CLI_HOME_PATH</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>homePath <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">CLI_HOME_PATH</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>homePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>userHome<span class="token punctuation">,</span><span class="token constant">DEFAULT_CLI_HOME</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        log<span class="token punctuation">.</span><span class="token function">verbose</span><span class="token punctuation">(</span><span class="token string">'home:'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>homePath <span class="token punctuation">)</span>
        fse<span class="token punctuation">.</span><span class="token function">ensureDirSync</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>homePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>homePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'ç”¨æˆ·ä¸»ç›®å½•è·å–å¤±è´¥ï¼'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Git init'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Git<span class="token punctuation">;</span>
</code></pre></div><blockquote><p>æœ¬èŠ‚å¯¹path/fs/user-home/fs-extraè¿›è¡Œç®€å•å›é¡¾ã€‚</p></blockquote> <ul><li>pathï¼šnodeå†…ç½®ï¼Œpathæ¨¡å—æä¾›äº†å¤„ç†æ–‡ä»¶å’Œç›®å½•çš„è·¯å¾„çš„å®ç”¨å·¥å…·ã€‚
<ul><li><strong>path.dirname(path)</strong> ,è¿”å›something(æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹)æ‰€åœ¨çš„æ–‡ä»¶ç›®å½•ã€‚</li> <li><strong>path.extname(path)</strong>:è¿”å›æœ€åä¸€æ¬¡å‡ºç°**.**å­—ç¬¦åˆ°å­—ç¬¦ä¸²çš„ç»“å°¾</li> <li><strong>path.isAbsolute(path)</strong>:ç¡®å®šè¿™ä¸ªpathè·¯å¾„æ˜¯å¦ä¸ºç»å¯¹è·¯å¾„ã€‚</li> <li><strong>path.join([...paths])</strong>:è·¯å¾„æ‹¼æ¥</li> <li>**path.parse(path)ğŸ˜—*å°†è·¯å¾„è¿”å›æˆä¸€ä¸ªå¯¹è±¡{root,dir,name,ext,base}</li> <li><strong>path.resolve(path):<strong>å°†è·¯å¾„æˆ–è·¯å¾„ç‰‡æ®µçš„åºåˆ—è§£æä¸º</strong>ç»å¯¹è·¯å¾„</strong>ï¼Œç»™å®šçš„è·¯å¾„åºåˆ—ä»å³å‘å·¦å¤„ç†</li> <li>**path.seq:**windowä¸Šæ˜¯\ï¼ŒMacä¸Šæ˜¯/</li></ul></li> <li>fsï¼šnodeå†…ç½®ï¼Œæ–‡ä»¶ç³»ç»Ÿ
<ul><li>**fs.existsSync(path)ğŸ˜—*å¦‚æœè·¯å¾„å­˜åœ¨è¿”å›trueï¼Œä¸å­˜åœ¨è¿”å›false</li></ul></li> <li>user-home\fs-extra:ç¬¬ä¸‰æ–¹</li></ul> <p><strong>3-3 é€‰æ‹©è¿œç¨‹Gitä»“åº“é€»è¾‘å¼€å‘</strong></p> <ul><li>ä¸Šä¸€èŠ‚çš„å†…å®¹æ€»ç»“ä¸€å¥å¤§ç™½è¯å°±æ˜¯ï¼šè·å– /User/username/.cloudscope-cliç›®å½•ï¼Œå¦‚æœæ²¡æœ‰å°±åˆ›å»ºã€‚</li> <li>æœ¬èŠ‚çš„å†…å®¹ä¸€å¥è¯æ€»ç»“å°±æ˜¯å®ç°äº†ä¸€ä¸ª<strong>checkGitServer</strong>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä¸»è¦åŠŸèƒ½æ˜¯æ£€æŸ¥åœ¨ä¸Šæ–‡æåˆ°çš„.cloudscope-cliä¸‹æ˜¯å¦æœ‰.git/.git-serveræ–‡ä»¶ï¼Œæ²¡æœ‰çš„è¯é€šè¿‡ inquirerè¯¢é—®åˆ›å»º</li> <li>ä¸”åœ¨ @cloudscope-cli/utilsä¸‹æ–°å»ºäº†** readFile**å’ŒwriteFileæ–¹æ³•</li> <li>å¹¶ä¸”æ·»åŠ äº†ä¸€ä¸ªå‚æ•°ï¼šrefreshServerï¼Œå¦‚æœæœ‰è¿™ä¸ªå‚æ•°å°±åˆ¤æ–­æ˜¯å¦é‡å†™.git-serveræ–‡ä»¶</li></ul> <p>æœ¬èŠ‚æ–°å¼€å‘æ·»åŠ ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> readFile<span class="token punctuation">,</span>writeFile <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@cloudscope-cli/utils'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> inquirer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'inquirer'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token constant">DEFAULT_CLI_HOME</span> <span class="token operator">=</span> <span class="token string">'.cloudscope-cli'</span>
<span class="token keyword">const</span> <span class="token constant">GIT_ROOT_DIR</span> <span class="token operator">=</span> <span class="token string">'.git'</span>
<span class="token keyword">const</span> <span class="token constant">GIT_SERVER_FILE</span> <span class="token operator">=</span> <span class="token string">'.git_server'</span>

<span class="token keyword">const</span> <span class="token constant">GITHUB</span> <span class="token operator">=</span> <span class="token string">'github'</span>
<span class="token keyword">const</span> <span class="token constant">GITEE</span> <span class="token operator">=</span><span class="token string">'gitee'</span>
<span class="token keyword">const</span> <span class="token constant">GIT_SERVER_TYPE</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'Github'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token constant">GITHUB</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Gitee'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token constant">GITEE</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span>  

 <span class="token keyword">async</span> <span class="token function">prepare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">checkHomePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æ£€æŸ¥ç¼“å­˜ä¸»ç›®å½•</span>
        <span class="token keyword">await</span>  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">checkGitServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ£€æŸ¥ç”¨æˆ·è¿œç¨‹ä»“åº“ç±»å‹</span>
 <span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token function">checkGitServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> gitServerPath <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createPath</span><span class="token punctuation">(</span><span class="token constant">GIT_SERVER_FILE</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> gitServer <span class="token operator">=</span> <span class="token function">readFile</span><span class="token punctuation">(</span>gitServerPath<span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>gitServer<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// å¦‚æœæ²¡æœ‰è¯»å–åˆ°.git-serveræ–‡ä»¶ä¸­çš„å†…å®¹</span>
            gitServer <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">choiceServer</span><span class="token punctuation">(</span>gitServerPath<span class="token punctuation">)</span>
            log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'git server å†™å…¥æˆåŠŸ'</span><span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>gitServer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> -&gt; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>gitServerPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token comment">// å¦‚æœè¯»å–åˆ°äº† å†…å®¹</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>refreshServer<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// æ˜¯å¦é‡å†™æ ‡è¯†</span>
                <span class="token keyword">const</span> refresh <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'confirm'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'ifContinue'</span><span class="token punctuation">,</span>
                    <span class="token keyword">default</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">message</span><span class="token operator">:</span><span class="token string">'å½“å‰.git-serverç›®å½•å·²å­˜åœ¨ï¼Œæ˜¯å¦è¦é‡å†™é€‰æ‹©æ‰˜ç®¡å¹³å°ï¼Ÿ'</span>
                <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ifContinue
                <span class="token keyword">if</span><span class="token punctuation">(</span>refresh<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    gitServer <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">choiceServer</span><span class="token punctuation">(</span>gitServerPath<span class="token punctuation">)</span>
                    log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'git server é‡å†™æˆåŠŸ'</span><span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>gitServer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> -&gt; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>gitServerPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                    log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'git server è·å–æˆåŠŸ '</span><span class="token punctuation">,</span> gitServer<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token comment">//ä¸é‡å†™ï¼Œç›´æ¥è¯»å–</span>
                log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'git server è·å–æˆåŠŸ '</span><span class="token punctuation">,</span> gitServer<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>gitServer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>gitServer<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">choiceServer</span><span class="token punctuation">(</span><span class="token parameter">gitServerPath</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> gitServer <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'list'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'server'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">message</span><span class="token operator">:</span><span class="token string">'è¯·é€‰æ‹©ä½ æƒ³è¦æ‰˜ç®¡çš„Gitå¹³å°'</span><span class="token punctuation">,</span>
            <span class="token keyword">default</span><span class="token operator">:</span> <span class="token constant">GITHUB</span><span class="token punctuation">,</span>
            <span class="token literal-property property">choices</span><span class="token operator">:</span><span class="token constant">GIT_SERVER_TYPE</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>server<span class="token punctuation">;</span>
        <span class="token function">writeFile</span><span class="token punctuation">(</span>gitServerPath<span class="token punctuation">,</span>gitServer<span class="token punctuation">)</span>
        <span class="token keyword">return</span> gitServer
    <span class="token punctuation">}</span>

    <span class="token function">createPath</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> rootDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>homePath<span class="token punctuation">,</span><span class="token constant">GIT_ROOT_DIR</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> serverDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>rootDir<span class="token punctuation">,</span>file<span class="token punctuation">)</span>
        fse<span class="token punctuation">.</span><span class="token function">ensureDirSync</span><span class="token punctuation">(</span>rootDir<span class="token punctuation">)</span>
        <span class="token keyword">return</span> serverDir
    <span class="token punctuation">}</span>
</code></pre></div><p>@cloudscope-cli/utils ä¸‹çš„readFileå’ŒwriteFileæ–¹æ³•å®ç°ä¸ºä½¿ç”¨nodeè‡ªå¸¦çš„fs.readFileSync(path)å’Œfs.writeFileSync(path)æ–¹æ³•</p> <p><strong>3-4 åˆ›å»ºGitServerç±»</strong><br>
æœ¬èŠ‚ä¸»è¦åˆ›å»ºäº†ä¸€ä¸ªGitServerç±»ï¼Œå¹¶æ–°å»ºGithubç±»å’ŒGiteeç±»åˆ†åˆ«ç»§æ‰¿GitServerã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token parameter">methodName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>methodName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> must be implemented!</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">GitServer</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span>token</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>type<span class="token operator">=</span> type
        <span class="token keyword">this</span><span class="token punctuation">.</span>token <span class="token operator">=</span> token
    <span class="token punctuation">}</span>

    <span class="token function">setToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'setToken'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">createRepo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'createRepo'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">createOrgRepo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'createOrgRepo'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">getRemote</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'getRemote'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">getuser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'getuser'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">getOrg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'getOrg'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> GitServer
</code></pre></div><p><strong>3-5 ç”Ÿæˆè¿œç¨‹ä»“åº“Tokené€»è¾‘å¼€å‘</strong></p> <p>æœ¬èŠ‚è¯¾çš„ä¸»è¦å†…å®¹ä¸ºç”Ÿæˆè¿œç¨‹ä»“åº“Tokenã€‚</p> <ul><li>é¦–å…ˆåœ¨ç±»Github.jså’ŒGitee.jsä¸­åˆ†åˆ«å®ç°è·å–å¸®åŠ©æ–‡æ¡£å’Œç›¸åº”tokençš„æ–‡æ¡£æ–¹æ³•</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//Github.js</span>
    <span class="token function">getSSHKeysUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token string">'https://gitee.com/profile/sshkeys'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token comment">//Gitee.js</span>
		<span class="token function">getSSHKeysUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">'https://gitee.com/profile/sshkeys'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">getTokenHelpUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">'https://gitee.com/help/articles/4191'</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>ç„¶ååœ¨models/git/index.jsä¸­å®ç°è·å–Giteetokençš„æ–¹æ³•</p> <ul><li>å®‰è£…äº†  terminal-linkåº“ï¼Œä¸”ç‰ˆæœ¬å·ä¸º2.1.1ï¼ŒåŠŸèƒ½æ˜¯ç›´æ¥åœ¨ternimalä¸­ç‚¹å‡»è·³è½¬é“¾æ¥</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>	<span class="token keyword">const</span> terminalLink <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'terminal-link'</span><span class="token punctuation">)</span>	
	<span class="token keyword">const</span> <span class="token constant">GIT_TOKEN_FILE</span> <span class="token operator">=</span> <span class="token string">'.git_token'</span>

	<span class="token keyword">async</span> <span class="token function">checkGitToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> tokenPath <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createPath</span><span class="token punctuation">(</span><span class="token constant">GIT_TOKEN_FILE</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> token <span class="token operator">=</span> <span class="token function">readFile</span><span class="token punctuation">(</span>tokenPath<span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>token <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>refreshServer<span class="token punctuation">)</span><span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gitServer<span class="token punctuation">.</span>type <span class="token operator">+</span> <span class="token string">' tokenæœªç”Ÿæˆ,è¯·å…ˆç”Ÿæˆï¼'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gitServer<span class="token punctuation">.</span>type <span class="token operator">+</span> <span class="token string">' token,'</span><span class="token operator">+</span><span class="token function">terminalLink</span><span class="token punctuation">(</span><span class="token string">'é“¾æ¥'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>gitServer<span class="token punctuation">.</span><span class="token function">getTokenHelpUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
            token <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'password'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'token'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">message</span><span class="token operator">:</span><span class="token string">'è¯·å°†tokenå¤åˆ¶åˆ°è¿™é‡Œ'</span><span class="token punctuation">,</span>
                <span class="token keyword">default</span><span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>token
            <span class="token function">writeFile</span><span class="token punctuation">(</span>tokenPath<span class="token punctuation">,</span>token<span class="token punctuation">)</span>
            log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'token å†™å…¥æˆåŠŸ'</span><span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tokenPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'tokenè·å–æˆåŠŸ'</span><span class="token punctuation">,</span>tokenPath<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>token  <span class="token operator">=</span> token
        <span class="token keyword">this</span><span class="token punctuation">.</span>gitServer<span class="token punctuation">.</span><span class="token function">setToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre></div><p><strong>3-6 Gitee APIæ¥å…¥+è·å–ç”¨æˆ·ç»„ç»‡ä¿¡æ¯åŠŸèƒ½å¼€å‘</strong></p> <p>æœ¬ç« èŠ‚ä¸»è¦æ˜¯Gitee APIçš„æ¥å…¥ï¼šè·å–ç”¨æˆ·ä¿¡æ¯å’Œç»„ç»‡ä¿¡æ¯</p> <ul><li>ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“æœ‰ axios</li> <li>æ–°å»ºçš„æ–‡ä»¶æœ‰ GitServerRequest.js</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'axios'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token constant">BASE_URL</span> <span class="token operator">=</span> <span class="token string">'https://gitee.com/api/v5'</span>

<span class="token keyword">class</span> <span class="token class-name">GiteeRequest</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">token</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>token <span class="token operator">=</span> token
        <span class="token keyword">this</span><span class="token punctuation">.</span>service <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">baseURL</span><span class="token operator">:</span><span class="token constant">BASE_URL</span><span class="token punctuation">,</span>
            <span class="token literal-property property">timeout</span><span class="token operator">:</span><span class="token number">5000</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>service<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
            <span class="token parameter">response</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
                <span class="token keyword">return</span> response<span class="token punctuation">.</span>data
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token parameter">error</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>response <span class="token operator">&amp;&amp;</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token keyword">return</span> error<span class="token punctuation">.</span>response
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>params<span class="token punctuation">,</span>headers<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            url<span class="token punctuation">,</span>
            <span class="token literal-property property">params</span><span class="token operator">:</span><span class="token punctuation">{</span>
                <span class="token operator">...</span>params<span class="token punctuation">,</span>
                <span class="token literal-property property">access_token</span><span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>token
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">'get'</span><span class="token punctuation">,</span>
            headers<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> GiteeRequest
</code></pre></div><p>index.jsä¸»ä»£ç ä¸»è¦å®ç°çš„æ–¹æ³•æ˜¯getUserAndOrgsï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token function">getUserAndOrgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gitServer<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'ç”¨æˆ·ä¿¡æ¯è·å–å¤±è´¥'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>orgs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gitServer<span class="token punctuation">.</span><span class="token function">getOrg</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>user<span class="token punctuation">.</span>login<span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>orgs<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'ç»„ç»‡ä¿¡æ¯è·å–å¤±è´¥'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gitServer<span class="token punctuation">.</span>type <span class="token operator">+</span> <span class="token string">' ç”¨æˆ·å’Œç»„ç»‡ä¿¡æ¯è·å–æˆåŠŸ'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre></div><p><strong>3-7 Github APIæ¥å…¥å¼€å‘</strong></p> <p>æœ¬èŠ‚ä»£ç ç±»ä¼¼äºGitee APIï¼Œä¸åŒç‚¹åœ¨äºï¼ŒGithub APIéœ€è¦åœ¨headersä¸­ä¼ å…¥tokenï¼š<em>config</em>.headers['Authorization'] =<code>token ${**this**.token}</code>
ç„¶åï¼ŒåŸºç¡€BASE_URLæ›´æ¢ï¼Œè·å–ç»„ç»‡URLæ›´æ¢ï¼Œæ”¹åŠ¨éƒ¨åˆ†ä»£ç å³å¯ã€‚</p> <p><strong>3-8 è¿œç¨‹ä»“åº“ç±»å‹é€‰æ‹©é€»è¾‘å¼€å‘</strong></p> <p>ä¹‹å‰çš„ç« èŠ‚æˆ‘ä»¬é€‰æ‹©äº†Gitæ‰˜ç®¡ç±»å‹ï¼Œç”Ÿæˆäº†ç›¸å…³æ‰˜ç®¡å¹³å°çš„tokenï¼Œè·å–åˆ°äº†ä¸ªäººå’Œç»„ç»‡çš„ä¿¡æ¯ï¼Œç„¶åè¿™èŠ‚æˆ‘ä»¬å°†è¦ç»§ç»­é€‰æ‹©ï¼šç¡®è®¤è¿œç¨‹ä»“åº“çš„ç±»å‹(æ˜¯ä¸ªäººè¿˜æ˜¯ç»„ç»‡)ï¼Œå¦‚æœæˆ‘ä»¬æ‹¿åˆ°çš„ä¿¡æ¯åªæœ‰ä¸ªäººï¼Œé‚£ä¹ˆå°±ä¸æ˜¾ç¤ºç»„ç»‡é€‰é¡¹ã€‚</p> <p>åŒæ ·ï¼Œæˆ‘ä»¬è¦å°†æ‹¿åˆ°çš„ä¸ªäººæˆ–è€…ç»„ç»‡ç™»å½•å(login)ä»¥åŠç±»å‹(owner)å†™å…¥åˆ°ç¼“å­˜æ–‡ä»¶ä¸­.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token constant">GIT_OWN_FILE</span> <span class="token operator">=</span> <span class="token string">'.git_own'</span>
<span class="token keyword">const</span> <span class="token constant">GIT_LOGIN_FILE</span> <span class="token operator">=</span> <span class="token string">'.git_login'</span>

<span class="token keyword">const</span> <span class="token constant">REPO_OWNER_USER</span> <span class="token operator">=</span> <span class="token string">'user'</span>
<span class="token keyword">const</span> <span class="token constant">REPO_OWNER_ORG</span> <span class="token operator">=</span> <span class="token string">'org'</span>
<span class="token keyword">const</span> <span class="token constant">GIT_OWNER_TYPE</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'ä¸ªäºº'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token constant">REPO_OWNER_USER</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'ç»„ç»‡'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token constant">REPO_OWNER_ORG</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> <span class="token constant">GIT_OWNER_TYPE_ONLY</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'ä¸ªäºº'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token constant">REPO_OWNER_USER</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span>

â€¦â€¦â€¦â€¦â€¦â€¦
<span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">checkGitOwner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç¡®è®¤è¿œç¨‹ä»“åº“ç±»å‹</span>
â€¦â€¦â€¦â€¦â€¦â€¦

<span class="token keyword">async</span> <span class="token function">checkGitOwner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> ownerPath <span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createPath</span><span class="token punctuation">(</span><span class="token constant">GIT_OWN_FILE</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
        <span class="token keyword">const</span> loginPath <span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createPath</span><span class="token punctuation">(</span><span class="token constant">GIT_LOGIN_FILE</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
        <span class="token keyword">let</span> owner <span class="token operator">=</span> <span class="token function">readFile</span><span class="token punctuation">(</span>ownerPath<span class="token punctuation">)</span>
        <span class="token keyword">let</span> login <span class="token operator">=</span> <span class="token function">readFile</span><span class="token punctuation">(</span>loginPath<span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>owner <span class="token operator">||</span> <span class="token operator">!</span>login <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>refreshOwner<span class="token punctuation">)</span><span class="token punctuation">{</span>
            owner <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'list'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'owner'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">message</span><span class="token operator">:</span><span class="token string">'è¯·é€‰æ‹©è¿œç¨‹ä»“åº“ç±»å‹'</span><span class="token punctuation">,</span>
                <span class="token keyword">default</span><span class="token operator">:</span> <span class="token constant">REPO_OWNER_USER</span><span class="token punctuation">,</span>
                <span class="token literal-property property">choices</span><span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>orgs<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token constant">GIT_OWNER_TYPE</span> <span class="token operator">:</span> <span class="token constant">GIT_OWNER_TYPE_ONLY</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>owner
            <span class="token keyword">if</span><span class="token punctuation">(</span>owner <span class="token operator">===</span> <span class="token constant">REPO_OWNER_USER</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                login <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>user<span class="token punctuation">.</span>login
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                login <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'list'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'login'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">message</span><span class="token operator">:</span><span class="token string">'è¯·é€‰æ‹©'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">choices</span><span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>orgs<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        <span class="token literal-property property">name</span><span class="token operator">:</span>item<span class="token punctuation">.</span>login<span class="token punctuation">,</span>
                        <span class="token literal-property property">value</span><span class="token operator">:</span> item<span class="token punctuation">.</span>login<span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>login
            <span class="token punctuation">}</span>
            <span class="token function">writeFile</span><span class="token punctuation">(</span>ownerPath<span class="token punctuation">,</span>owner<span class="token punctuation">)</span>
            <span class="token function">writeFile</span><span class="token punctuation">(</span>loginPath<span class="token punctuation">,</span>login<span class="token punctuation">)</span>
            log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'owner å†™å…¥æˆåŠŸ'</span><span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>owner<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> -&gt; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ownerPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
            log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'login å†™å…¥æˆåŠŸ'</span><span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>login<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> -&gt; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>loginPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'owner è¯»å–æˆåŠŸ'</span><span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>owner<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> -&gt; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ownerPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
            log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'login è¯»å–æˆåŠŸ'</span><span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>login<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> -&gt; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>loginPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>owner <span class="token operator">=</span> owner
        <span class="token keyword">this</span><span class="token punctuation">.</span>login <span class="token operator">=</span> login
    <span class="token punctuation">}</span>
</code></pre></div><h2 id="ç¬¬å››ç« -gitflow-åˆå§‹åŒ–æµç¨‹å¼€å‘"><a href="#ç¬¬å››ç« -gitflow-åˆå§‹åŒ–æµç¨‹å¼€å‘" class="header-anchor">#</a> ç¬¬å››ç«  GitFlow åˆå§‹åŒ–æµç¨‹å¼€å‘</h2> <p><strong>4-1 Giteeè·å–å’Œåˆ›å»ºä»“åº“APIæ¥å…¥</strong></p> <ul><li>è¿™èŠ‚çš„ä»£ç ï¼Œå‡ºäº†ä¸€ä¸ªå°bugï¼Œè°ƒè¯•åˆ°äº†å¤©äº®,bugæ–¹æ³•çš„å®ç°ä¸ºä¸‹é¢ç¤ºä¾‹50è¡Œï¼šthis.handleResponse(response)ï¼Œè¯¾ç¨‹ä»£ç è®²åˆ°åœ¨è·å–ä¸€ä¸ªä»“åº“çš„APIæ—¶æ²¡æœ‰statuså‚æ•°ï¼Œç»æµ‹è¯•æ˜¯æœ‰çš„ã€‚</li> <li>æœ¬èŠ‚<strong>ä¸»è¦</strong>å®Œæˆçš„åŠŸèƒ½æœ‰ï¼š
<ul><li>æ£€æŸ¥å¹¶åˆ›å»ºè¿œç¨‹ä»“åº“ **checkRepo **æ–¹æ³•å®ç°</li> <li>GiteeRequestæ·»åŠ postè¯·æ±‚</li> <li>Giteeç±»å®ç° **createRepo()**å’Œ <strong>getRepo()</strong> æ–¹æ³•</li></ul></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">checkRepo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  æ£€æŸ¥å¹¶åˆ›å»ºè¿œç¨‹ä»“åº“</span>

<span class="token comment">//models/git/lib/index.js</span>
<span class="token keyword">async</span> <span class="token function">checkRepo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> repo <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gitServer<span class="token punctuation">.</span><span class="token function">getRepo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>login<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  log<span class="token punctuation">.</span><span class="token function">verbose</span><span class="token punctuation">(</span><span class="token string">'repo'</span><span class="token punctuation">,</span>repo<span class="token punctuation">)</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>repo<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//å¦‚æœè¿œç¨‹ä»“åº“ä¸å­˜åœ¨ï¼Œå°±å»åˆ›å»º</span>
    <span class="token keyword">let</span> spinner <span class="token operator">=</span> <span class="token function">spinnerStart</span><span class="token punctuation">(</span><span class="token string">'å¼€å§‹åˆ›å»ºè¿œç¨‹ä»“åº“'</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>owner <span class="token operator">===</span> <span class="token constant">REPO_OWNER_USER</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        repo <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gitServer<span class="token punctuation">.</span><span class="token function">createRepo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
        log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'ç”¨æˆ·ä¸ªäººè¿œç¨‹ä»“åº“åˆ›å»ºæˆåŠŸï¼'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>gitServer<span class="token punctuation">.</span><span class="token function">createOrgRepo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>login<span class="token punctuation">)</span>
        log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'ç”¨æˆ·ç»„ç»‡è¿œç¨‹ä»“åº“åˆ›å»ºæˆåŠŸ1'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>
      spinner<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>repo<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'è¿œç¨‹ä»“åº“åˆ›å»ºå¤±è´¥'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'è¿œç¨‹ä»“åº“å·²å­˜åœ¨ä¸”è·å–æˆåŠŸï¼'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>repo <span class="token operator">=</span> repo
<span class="token punctuation">}</span>

<span class="token comment">//models/git/lib/GiteeRequest.js</span>
 <span class="token function">post</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span>data<span class="token punctuation">,</span>headers</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
     url<span class="token punctuation">,</span>
     <span class="token literal-property property">params</span><span class="token operator">:</span><span class="token punctuation">{</span>
       <span class="token literal-property property">access_token</span><span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">,</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
     data<span class="token punctuation">,</span>
     <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">'POST'</span><span class="token punctuation">,</span>
     headers
   <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

<span class="token comment">//models/git/lib/Gitee.js</span>
<span class="token function">getRepo</span><span class="token punctuation">(</span><span class="token parameter">login<span class="token punctuation">,</span>name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//GET https://gitee.com/api/v5/repos/{owner}/{repo}</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>request
    <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/repos/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>login<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleResponse</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">createRepo</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// POST https://gitee.com/api/v5/user/repos</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/user/repos'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    name<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>4-2 Githubè·å–å’Œåˆ›å»ºä»“åº“APIæ¥å…¥</strong></p> <p>ä¸Giteeè·å–å’Œåˆ›å»ºä»“åº“APIç±»ä¼¼ã€‚GithubRequeståŒæ ·å®ç°äº†postæ–¹æ³•ã€‚</p> <p>ç±»GithubåŒæ ·å®ç°äº†getRepoå’ŒcreateRepoæ–¹æ³•ã€‚</p> <p><strong>4-3 Github&amp;Giteeç»„ç»‡ä»“åº“åˆ›å»ºAPIæ¥å…¥</strong></p> <p>æœ¬èŠ‚å†…å®¹è¾ƒä¸ºç®€å•ï¼Œå®ç°äº†è¿œç¨‹åˆ›å»ºç»„ç»‡ä»“åº“API</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">createOrgRepo</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>login</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/orgs/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>login<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/repos</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    name
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    <span class="token literal-property property">accept</span><span class="token operator">:</span><span class="token string">'application/vnd.github.v3+json'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>4-4 gitignoreæ–‡ä»¶æ£€æŸ¥</strong></p> <p>æäº¤å‡†å¤‡å·¥ä½œï¼šæœ‰äº›é¡¹ç›®æ²¡æœ‰é»˜è®¤åˆ›å»º.gitignore,å› æ­¤ä¼šå¼•å‘æäº¤å¤§é‡æ— ç”¨æˆ–æ— å…³ä»£ç ã€‚</p> <p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ£€æŸ¥å¹¶åˆ›å»º.gitignoreæ–‡ä»¶çš„æ–¹æ³•</p> <p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯å®‰è£…çš„.gitignoreå®‰è£…ç›®å½•ä¸ºå½“å‰æ‰§è¡Œæ–‡ä»¶ï¼Œè€Œä¸æ˜¯ç¼“å­˜æ–‡ä»¶</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token constant">GIT_IGNORE_FILE</span><span class="token operator">=</span><span class="token string">'.gitignore'</span>

<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">checkGitIgnore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ£€æŸ¥å¹¶åˆ›å»º.gitignoreæ–‡ä»¶</span>

<span class="token function">checkGitIgnore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> gitIgnorePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dir<span class="token punctuation">,</span><span class="token constant">GIT_IGNORE_FILE</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gitIgnorePath<span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>gitIgnorePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">writeFile</span><span class="token punctuation">(</span>gitIgnorePath<span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">.DS_Store
node_modules
/dist


# local env files
.env.local
.env.*.local

# Log files
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*

# Editor directories and files
.idea
.vscode
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
            log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">è‡ªåŠ¨å†™å…¥</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">GIT_IGNORE_FILE</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">æ–‡ä»¶æˆåŠŸï¼</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><p><strong>4-5 gitæœ¬åœ°ä»“åº“åˆå§‹åŒ–å’Œè¿œç¨‹ä»“åº“ç»‘å®š</strong></p> <blockquote><p>æœ¬èŠ‚ä¸»è¦å®Œæˆçš„åŠŸèƒ½ä¸ºæœ¬åœ°çš„ä»“åº“çš„åˆå§‹åŒ–ï¼šå³æ‰§è¡Œgit initæ–¹æ³•å’Œgit addRemoteæ–¹æ³•ã€‚</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å®Œæˆæœ¬åœ°ä»“åº“åˆå§‹åŒ–</span>

 <span class="token keyword">async</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getRemote</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token keyword">return</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initAndAddRemote</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token function">initAndAddRemote</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'æ‰§è¡Œgitåˆå§‹åŒ–'</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dir<span class="token punctuation">)</span>
  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'æ·»åŠ git remote'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> remotes <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span><span class="token function">getRemotes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'git remotes'</span><span class="token punctuation">,</span>remotes<span class="token punctuation">)</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>remotes<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'origin'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span><span class="token function">addRemote</span><span class="token punctuation">(</span><span class="token string">'origin'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>remote<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token function">getRemote</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> gitPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dir<span class="token punctuation">,</span><span class="token constant">GIT_ROOT_DIR</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>remote <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gitServer<span class="token punctuation">.</span><span class="token function">getRemote</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>login<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>gitPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'gitå·²å®Œæˆåˆå§‹åŒ–'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>4-6 gitè‡ªåŠ¨åŒ–æäº¤åŠŸèƒ½å¼€å‘</strong></p> <p>ä¸Šä¸€èŠ‚çš„æµç¨‹åœ¨æœ¬åœ°å®ç°äº†ä¸¤ä¸ªæ“ä½œ</p> <ul><li><strong>git init</strong></li> <li><strong>git remote add origin 'git@github.com:${login}/${name}.git'</strong></li></ul> <p>ç´§æ¥ç€è¿™ä¸€èŠ‚æŒ‰ç…§æœ¬åœ°çš„æ“ä½œï¼Œæˆ‘ä»¬åº”è¯¥å®ç°  git add. / git commit -m'çš„æ“ä½œã€‚</p> <p>æœ¬èŠ‚å®ç°initCommit()æ–¹æ³•ï¼š</p> <ul><li>é¦–å…ˆæ£€æŸ¥æ˜¯å¦æœ‰ä»£ç å†²çª</li> <li>ç„¶åæ£€æŸ¥ä»£ç æ˜¯å¦æœ‰æœªæäº¤</li> <li>ç„¶ååˆ¤æ–­è¿œç¨‹åˆ†æ”¯æ˜¯å¦å·²å­˜åœ¨
<ul><li>ä¸å­˜åœ¨çš„è¯ç›´æ¥pushä»£ç </li> <li>å­˜åœ¨çš„è¯å°±éœ€è¦ä½¿ç”¨git pullå»æ‹‰å–ä»£ç ï¼Œä¸”ä½¿ç”¨ '--allow-unrelated-histories:all':null å‚æ•°ã€‚</li></ul></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token keyword">async</span> <span class="token function">initCommit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">checkConflicted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ£€æŸ¥ä»£ç å†²çª</span>
   <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">checkNotCommitted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ£€æŸ¥ä»£ç æœªæäº¤</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">checkRemoteMaster</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//åˆ¤æ–­è¿œç¨‹ä»“åº“masteråˆ†æ”¯æ˜¯å¦å·²å­˜åœ¨</span>
     <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">pullRemoteRepo</span><span class="token punctuation">(</span><span class="token string">'master'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
       <span class="token string-property property">'--allow-unrelated-histories'</span><span class="token operator">:</span><span class="token keyword">null</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
     <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">pushRemoteRepo</span><span class="token punctuation">(</span><span class="token string">'master'</span><span class="token punctuation">)</span>  <span class="token comment">//å¦‚æœä¸å­˜åœ¨ç›´æ¥pushä»£ç </span>
   <span class="token punctuation">}</span>

 <span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token function">checkConflicted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'ä»£ç å†²çªæ£€æŸ¥'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> status <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span>conflicted<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'å½“ç„¶ä»£ç å­˜åœ¨å†²çªï¼Œè¯·æ‰‹åŠ¨å¤„ç†åˆå¹¶åå†è¯•'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'ä»£ç å†²çªæ£€æŸ¥é€šè¿‡'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token function">checkNotCommitted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> status <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span>not_added<span class="token punctuation">.</span>length <span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">||</span> 
     status<span class="token punctuation">.</span>created<span class="token punctuation">.</span>length <span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">||</span>
     status<span class="token punctuation">.</span>deleted<span class="token punctuation">.</span>length<span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">||</span>
     status<span class="token punctuation">.</span>modified<span class="token punctuation">.</span>length<span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">||</span>
     status<span class="token punctuation">.</span>renamed<span class="token punctuation">.</span>length<span class="token operator">&gt;</span><span class="token number">0</span>
    <span class="token punctuation">)</span><span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">verbose</span><span class="token punctuation">(</span><span class="token string">'status'</span><span class="token punctuation">,</span>status<span class="token punctuation">)</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span>not_added<span class="token punctuation">)</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span>created<span class="token punctuation">)</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span>deleted<span class="token punctuation">)</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span>modified<span class="token punctuation">)</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span>renamed<span class="token punctuation">)</span>
    <span class="token keyword">let</span> message<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      message <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'text'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'message'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span><span class="token string">'è¯·è¾“å…¥commitä¿¡æ¯'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>message
    <span class="token punctuation">}</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
    log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'æœ¬æ¬¡commitæäº¤æˆåŠŸï¼'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token function">checkRemoteMaster</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// git ls-remote</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span><span class="token function">listRemote</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'--refs'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'refs/heads/master'</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span><span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token function">pushRemoteRepo</span><span class="token punctuation">(</span><span class="token parameter">branchName</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">æ¨é€ä»£ç è‡³</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>branchName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> åˆ†æ”¯</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'origin'</span><span class="token punctuation">,</span>branchName<span class="token punctuation">)</span>
  log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'æ¨é€ä»£ç æˆåŠŸï¼'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token function">pullRemoteRepo</span><span class="token punctuation">(</span><span class="token parameter">branchName<span class="token punctuation">,</span>options</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">åŒæ­¥è¿œç¨‹</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>branchName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">åˆ†æ”¯ä»£ç </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span><span class="token function">pull</span><span class="token punctuation">(</span><span class="token string">'origin'</span><span class="token punctuation">,</span>branchName<span class="token punctuation">,</span>options<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ç¬¬äº”ç« -gitflowæœ¬åœ°ä»“åº“ä»£ç è‡ªåŠ¨æäº¤"><a href="#ç¬¬äº”ç« -gitflowæœ¬åœ°ä»“åº“ä»£ç è‡ªåŠ¨æäº¤" class="header-anchor">#</a> ç¬¬äº”ç«  GitFlowæœ¬åœ°ä»“åº“ä»£ç è‡ªåŠ¨æäº¤</h2> <p><strong>5-1 è‡ªåŠ¨ç”Ÿæˆå¼€å‘åˆ†æ”¯åŸç†è®²è§£1</strong></p> <p>ç¬¬ä¸€éï¼šè¿™èŠ‚è¯¾å¬çš„æœ‰ç‚¹æ‡µé€¼ã€‚</p> <p><a href="https://www.processon.com/embed/610f8ef87d9c082be335ac23" target="_blank" rel="noopener noreferrer">ç‚¹å‡»æŸ¥çœ‹ã€processonã€‘<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>5-2 è‡ªåŠ¨ç”Ÿæˆå¼€å‘åˆ†æ”¯åŠŸèƒ½å¼€å‘</strong></p> <p>æœ¬èŠ‚ä¸»è¦å®ç°ä¸º è·å–è¿œç¨‹å‘å¸ƒåˆ†æ”¯åˆ—è¡¨(git ls-remote --refs)å’Œè·å–è¿œç¨‹æœ€æ–°å‘å¸ƒåˆ†æ”¯å·(é€šè¿‡æ­£åˆ™åŒ¹é…releaseåˆ†æ”¯ï¼Œå¹¶æ’åºè·å–æœ€æ–°åˆ†æ”¯)ï¼Œè¯¦ç»†ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> semver <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'semver'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token constant">VERSION_RELEASE</span> <span class="token operator">=</span> <span class="token string">'release'</span>
<span class="token keyword">const</span> <span class="token constant">VERSION_DEVELOP</span> <span class="token operator">=</span> <span class="token string">'dev'</span>

 <span class="token keyword">async</span> <span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// 1.ç”Ÿæˆå¼€å‘åˆ†æ”¯</span>
        <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getCorrectVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// 2.åœ¨å¼€å‘åˆ†æ”¯ä¸Šæäº¤ä»£ç </span>

        <span class="token comment">// 3.åˆå¹¶è¿œç¨‹å¼€å‘åˆ†æ”¯</span>

        <span class="token comment">//4.æ¨é€å¼€å‘åˆ†æ”¯</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">async</span> <span class="token function">getCorrectVersion</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token comment">// 1.è·å–è¿œç¨‹å‘å¸ƒåˆ†æ”¯</span>
         <span class="token comment">// è§„èŒƒï¼šrelease/x.y.z ,dev/x.y.z</span>
         <span class="token comment">// ç‰ˆæœ¬å·é€’å¢è§„èŒƒï¼šmajor/minor/patch</span>
         log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'è·å–è¿œç¨‹ä»“åº“ä»£ç åˆ†æ”¯'</span><span class="token punctuation">)</span>
         <span class="token keyword">const</span> remoteBranchList <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getRemoteBranchList</span><span class="token punctuation">(</span><span class="token constant">VERSION_RELEASE</span><span class="token punctuation">)</span>
         <span class="token keyword">let</span> releaseVersion <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>remoteBranchList <span class="token operator">&amp;&amp;</span> remoteBranchList<span class="token punctuation">.</span>length<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
             releaseVersion <span class="token operator">=</span> remoteBranchList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
         <span class="token punctuation">}</span>
         log<span class="token punctuation">.</span><span class="token function">verbose</span><span class="token punctuation">(</span><span class="token string">'releaseVersion'</span><span class="token punctuation">,</span>releaseVersion<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">async</span> <span class="token function">getRemoteBranchList</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> remoteList <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span><span class="token function">listRemote</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'--refs'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> reg<span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token constant">VERSION_RELEASE</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
            reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.+?refs\/tags\/release\/(\d+\.\d+\.\d+)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span>
         <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
         <span class="token punctuation">}</span>
        <span class="token keyword">return</span> remoteList<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">remote</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token keyword">const</span>  match <span class="token operator">=</span> reg<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>remote<span class="token punctuation">)</span>
            reg<span class="token punctuation">.</span>lastIndex <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>match <span class="token operator">&amp;&amp;</span>semver<span class="token punctuation">.</span><span class="token function">valid</span><span class="token punctuation">(</span>match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">return</span> match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">_</span> <span class="token operator">=&gt;</span> _ <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>semver<span class="token punctuation">.</span><span class="token function">lte</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">===</span>b<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        
    <span class="token punctuation">}</span>
</code></pre></div><p><strong>5-3 é«˜ç«¯æ“ä½œï¼šè‡ªåŠ¨å‡çº§ç‰ˆæœ¬å·åŠŸèƒ½å¼€å‘</strong></p> <p>æ ¹æ®5-1å›¾ç¤ºï¼Œä¸Šä¸¤èŠ‚æˆ‘ä»¬å®Œæˆçš„éƒ¨åˆ†ä¸ºï¼šè·å–è¿œç¨‹å‘å¸ƒåˆ†æ”¯å·åˆ—è¡¨ã€è·å–è¿œç¨‹æœ€æ–°å‘å¸ƒåˆ†æ”¯å·ï¼Œå¹¶åœ¨ä¸ŠèŠ‚ä»£ç ä¸­ç»è¿‡å¤„ç†ï¼Œæ‹¿åˆ°äº†æœ€æ–°çš„è¿œç¨‹å‘å¸ƒçš„ç‰ˆæœ¬å·ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å®ç°</p> <ul><li>åˆ¤æ–­æœ€æ–°å‘å¸ƒç‰ˆæœ¬å·æ˜¯å¦å­˜åœ¨
<ul><li>ä¸å­˜åœ¨ï¼šç”Ÿæˆæœ¬åœ°å¼€å‘åˆ†æ”¯</li> <li>å­˜åœ¨ï¼šä¸æœ¬åœ°å¼€å‘åˆ†æ”¯ç‰ˆæœ¬å·é€šè¿‡semverå¯¹æ¯”
<ul><li>æœ¬åœ°åˆ†æ”¯å°äºè¿œç¨‹æœ€æ–°å‘å¸ƒåˆ†æ”¯ç‰ˆæœ¬å·
<ul><li>é€šè¿‡inquirerè¯¢é—®é€‰æ‹©æœ¬åœ°ç‰ˆæœ¬çš„å‡çº§æ–¹å¼</li> <li>è·å–é€‰æ‹©å‡çº§çš„ç‰ˆæœ¬å·</li> <li>é‡æ–°å†™å…¥åˆ°æœ¬åœ°package.jsonä¸­çš„versionä¸­å»</li></ul></li> <li>æœ¬åœ°åˆ†æ”¯å¤§äºè¿œç¨‹æœ€æ–°å‘å¸ƒåˆ†æ”¯ç‰ˆæœ¬å·</li></ul></li></ul></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token keyword">this</span><span class="token punctuation">.</span>branch <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">//æœ¬åœ°å¼€å‘åˆ†æ”¯</span>


<span class="token comment">//æ¥ç€ä¸Šä¸€èŠ‚çš„ä»£ç ï¼Œåœ¨getCorrectVersionæ–¹æ³•ä¸­ç»§ç»­ï¼š</span>
 <span class="token comment">//2.ç”Ÿæˆæœ¬åœ°å¼€å‘åˆ†æ”¯</span>
<span class="token keyword">const</span> devVersion <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>version
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>releaseVersion<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// ä¸å­˜åœ¨è¿œç¨‹å‘å¸ƒåˆ†æ”¯</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>branch <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">VERSION_DEVELOP</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>devVersion<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>semver<span class="token punctuation">.</span><span class="token function">gt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>version<span class="token punctuation">,</span>releaseVersion<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//æœ¬åœ°åˆ†æ”¯å¤§äºè¿œç¨‹å‘å¸ƒåˆ†æ”¯</span>
  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'å½“å‰ç‰ˆæœ¬å¤§äºçº¿ä¸Šæœ€æ–°ç‰ˆæœ¬'</span><span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>devVersion<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> &gt;= </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>releaseVersion<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>branch <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">VERSION_DEVELOP</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>devVersion<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>  <span class="token keyword">else</span> <span class="token punctuation">{</span>
  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'å½“å‰çº¿ä¸Šç‰ˆæœ¬å¤§äºæœ¬åœ°ç‰ˆæœ¬'</span><span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>releaseVersion<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> &gt; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>devVersion<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> incType <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'list'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'incType'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span><span class="token string">'è‡ªåŠ¨å‡çº§ç‰ˆæœ¬ï¼Œè¯·é€‰æ‹©å‡çº§ç‰ˆæœ¬'</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token string">'patch'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">choices</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">å°ç‰ˆæœ¬(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>releaseVersion<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> -&gt; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>semver<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span>releaseVersion<span class="token punctuation">,</span><span class="token string">'patch'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">value</span><span class="token operator">:</span><span class="token string">'patch'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ä¸­ç‰ˆæœ¬(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>releaseVersion<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> -&gt; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>semver<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span>releaseVersion<span class="token punctuation">,</span><span class="token string">'minor'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">value</span><span class="token operator">:</span><span class="token string">'minor'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">å¤§ç‰ˆæœ¬(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>releaseVersion<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> -&gt; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>semver<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span>releaseVersion<span class="token punctuation">,</span><span class="token string">'major'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">value</span><span class="token operator">:</span><span class="token string">'major'</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>incType
  <span class="token keyword">const</span> incVersion <span class="token operator">=</span> semver<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span>releaseVersion<span class="token punctuation">,</span>incType<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>branch <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">VERSION_DEVELOP</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>incVersion<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>version <span class="token operator">=</span> incVersion
<span class="token punctuation">}</span>
log<span class="token punctuation">.</span><span class="token function">verbose</span><span class="token punctuation">(</span><span class="token string">'æœ¬åœ°å¼€å‘åˆ†æ”¯'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>branch<span class="token punctuation">)</span>
<span class="token comment">//3.å°†versionåŒæ­¥åˆ°package.json</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">syncVersionToPackageJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


 <span class="token function">syncVersionToPackageJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">const</span> pkg <span class="token operator">=</span> fse<span class="token punctuation">.</span><span class="token function">readJsonSync</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>dir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/package.json</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>pkg <span class="token operator">&amp;&amp;</span> pkg<span class="token punctuation">.</span>version<span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>version<span class="token punctuation">)</span><span class="token punctuation">{</span>
     pkg<span class="token punctuation">.</span>version <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>version
     fse<span class="token punctuation">.</span><span class="token function">writeJsonSync</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>dir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/package.json</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>pkg<span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">spaces</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre></div><p><strong>5-4 GitFlowä»£ç è‡ªåŠ¨æäº¤æµç¨‹æ¢³ç†+stashåŒºæ£€æŸ¥åŠŸèƒ½å¼€å‘</strong></p> <p><a href="https://www.processon.com/embed/610fe95c6376891eb94d7e38" target="_blank" rel="noopener noreferrer">ç‚¹å‡»æŸ¥çœ‹ã€processonã€‘<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>æœ¬åœ°æ‰§è¡Œgit status æœ‰æœªæäº¤çš„ä»£ç æ—¶ï¼Œæ‰§è¡Œ git stashå°†æœªæäº¤çš„ä»£ç ç¼“å­˜åœ¨stashåŒºå½“ä¸­ã€‚
ç„¶åé€šè¿‡git statuså‘½ä»¤å‘ç°ï¼Œæ²¡æœ‰ä»£ç å¯æäº¤
è¿™é‡Œæ¸©ä¹ äº†git stashçš„ä¸ªå‘½ä»¤ï¼šgit stash / git stash list / git stash pop</p></blockquote> <p>æœ¬èŠ‚ä»£ç å®ç°</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token function">checkStash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//1. æ£€æŸ¥stash list</span>
  <span class="token keyword">const</span> stashList <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span><span class="token function">stashList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>stashList<span class="token punctuation">.</span>all<span class="token punctuation">.</span>length <span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>git<span class="token punctuation">.</span>stash<span class="token punctuation">[</span><span class="token string">'pop'</span><span class="token punctuation">]</span>
    log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'stash popæˆåŠŸ'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>5-5 ä»£ç å†²çªå¤„ç†+Gitä»£ç åˆ é™¤åè¿˜åŸæ–¹æ³•è®²è§£</strong></p> <p>æœ¬èŠ‚ä»¥åŠä¸Šä¸€èŠ‚å¬çš„æœ‰äº›æ‡µé€¼ï¼Œéœ€è¦ç¬¬äºŒéé‡æ–°å­¦ä¹ </p> <p><strong>5-6 è‡ªåŠ¨åˆ‡æ¢å¼€å‘åˆ†æ”¯+åˆå¹¶è¿œç¨‹åˆ†æ”¯ä»£ç +æ¨é€ä»£ç åŠŸèƒ½å¼€å‘</strong></p> <p>å…ˆæš‚æ—¶ç•¥è¿‡ç¬”è®°ã€‚</p> <h2 id="ç¬¬å…­ç« -æœ¬å‘¨åŠ é¤-nodeç¼–ç æœ€ä½³å®è·µ"><a href="#ç¬¬å…­ç« -æœ¬å‘¨åŠ é¤-nodeç¼–ç æœ€ä½³å®è·µ" class="header-anchor">#</a> ç¬¬å…­ç«  æœ¬å‘¨åŠ é¤ï¼šNodeç¼–ç æœ€ä½³å®è·µ</h2> <p><strong>6-1 Nodeæœ€ä½³å®è·µå­¦ä¹ è¯´æ˜</strong></p> <ul><li>é€šè¿‡<a href="https://github.com/goldbergyoni/nodebestpractices/blob/master/README.chinese.md" target="_blank" rel="noopener noreferrer">https://github.com/goldbergyoni/nodebestpractices/blob/master/README.chinese.md<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>è¿™ä¸ªåº“å­¦ä¹ ã€‚</li> <li>éœ€è¦æœ‰nodeçš„å®è·µã€‚
<strong>6-2 Nodeé¡¹ç›®æ¶æ„æœ€ä½³å®è·µ</strong> <strong>6-3 Nodeå¼‚å¸¸å¤„ç†æœ€ä½³å®è·µ</strong></li></ul> <p><strong>ä»£ç ç¤ºä¾‹: æ•è· unresolved å’Œ rejected çš„ promise</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>process<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'unhandledRejection'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">reason<span class="token punctuation">,</span> p</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//æˆ‘åˆšåˆšæ•è·äº†ä¸€ä¸ªæœªå¤„ç†çš„promise rejection, å› ä¸ºæˆ‘ä»¬å·²ç»æœ‰äº†å¯¹äºæœªå¤„ç†é”™è¯¯çš„åå¤‡çš„å¤„ç†æœºåˆ¶ï¼ˆè§ä¸‹é¢ï¼‰, ç›´æ¥æŠ›å‡ºï¼Œè®©å®ƒæ¥å¤„ç†</span>
  <span class="token keyword">throw</span> reason<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
process<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'uncaughtException'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//æˆ‘åˆšæ”¶åˆ°ä¸€ä¸ªä»æœªè¢«å¤„ç†çš„é”™è¯¯ï¼Œç°åœ¨å¤„ç†å®ƒï¼Œå¹¶å†³å®šæ˜¯å¦éœ€è¦é‡å¯åº”ç”¨</span>
  errorManagement<span class="token punctuation">.</span>handler<span class="token punctuation">.</span><span class="token function">handleError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>errorManagement<span class="token punctuation">.</span>handler<span class="token punctuation">.</span><span class="token function">isTrustedError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span>
    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


</code></pre></div><p><strong>6-4 Nodeç¼–ç è§„èŒƒæœ€ä½³å®è·µ</strong> <strong>6-5 Nodeæµ‹è¯•+å®‰å…¨æœ€ä½³å®è·µ</strong></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/liugezhou/daydayup/edit/main//docs/web/29.md" target="_blank" rel="noopener noreferrer">é”™è¯¯åé¦ˆ</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/web/28.html" class="prev">
        28-è„šæ‰‹æ¶å‘å¸ƒæ¨¡å—æ¶æ„è®¾è®¡å’Œæ ¸å¿ƒæµç¨‹å¼€å‘
      </a></span> <span class="next"><a href="/web/30.html">
        30-è„šæ‰‹æ¶å‘å¸ƒæ¨¡å—äº‘æ„å»ºç³»ç»Ÿå¼€å‘
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.4690e35c.js" defer></script><script src="/assets/js/2.505fbce2.js" defer></script><script src="/assets/js/1.8644e8ec.js" defer></script><script src="/assets/js/76.886902cd.js" defer></script>
  </body>
</html>
